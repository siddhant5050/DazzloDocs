# Ultimate HTML to PDF Converter

The most powerful HTML to PDF converter with precise CSS rendering, perfect page breaks, and professional letterhead support. This converter ensures no overlapping content, no hidden elements, and delivers pixel-perfect PDFs every time.

## ✨ Features

- **🎯 Perfect CSS Rendering** - Exact reproduction of all CSS styles, gradients, flexbox, grid layouts
- **📄 Smart Page Management** - Intelligent page breaks with no overlapping content or empty pages
- **🏢 Professional Letterhead** - Add Trivanta Edge branding to all pages with company logo and contact info
- **🖼️ High-Quality Images** - Support for PNG, JPG, SVG, WebP with perfect rendering
- **📊 Professional Tables** - Proper table formatting with intelligent page breaks
- **🔤 Custom Fonts** - Google Fonts and web fonts with accurate rendering
- **⚡ Lightning Fast** - Optimized performance with advanced caching
- **🛡️ Reliable** - Robust error handling and memory management

## 🚀 Quick Start

### Prerequisites
- Node.js 16.0.0 or higher
- npm or yarn

### Installation
```bash
npm install
npm start
```

The web interface will be available at `http://localhost:3000`

## 📖 Usage

### Web Interface
1. Open `http://localhost:3000` in your browser
2. Choose input method: HTML String, Upload File, or URL
3. Configure options (format, orientation, margins, scale)
4. **Enable letterhead** checkbox to add Trivanta Edge branding
5. Click "Convert to PDF"

### Command Line Interface (CLI)

```bash
# Basic conversion
node cli.js input.html output.pdf

# With letterhead
node cli.js input.html output.pdf --letterhead

# Custom options
node cli.js input.html output.pdf --format A3 --landscape --margin large --scale 1.1 --letterhead

# Convert from URL
node cli.js https://example.com output.pdf --letterhead

# Convert from stdin
echo "<html><body><h1>Hello</h1></body></html>" | node cli.js - output.pdf --letterhead
```

### API Usage

#### Convert HTML String
```bash
curl -X POST http://localhost:3000/convert/html \
  -H "Content-Type: application/json" \
  -d '{
    "html": "<html><body><h1>Hello World</h1></body></html>",
    "format": "A4",
    "landscape": false,
    "margin": {"top": "12mm", "right": "10mm", "bottom": "14mm", "left": "10mm"},
    "scale": 1.0,
    "letterhead": true
  }'
```

#### Convert File Upload
```bash
curl -X POST http://localhost:3000/convert/file \
  -F "htmlFile=@input.html" \
  -F "format=A4" \
  -F "landscape=false" \
  -F "margin={\"top\":\"12mm\",\"right\":\"10mm\",\"bottom\":\"14mm\",\"left\":\"10mm\"}" \
  -F "scale=1.0" \
  -F "letterhead=true"
```

#### Convert URL
```bash
curl -X POST http://localhost:3000/convert/url \
  -H "Content-Type: application/json" \
  -d '{
    "url": "https://example.com",
    "format": "A4",
    "landscape": false,
    "margin": {"top": "12mm", "right": "10mm", "bottom": "14mm", "left": "10mm"},
    "scale": 1.0,
    "letterhead": true
  }'
```

### Programmatic Usage

```javascript
const UltimateHTMLToPDFConverter = require('./src/converter');

async function convertWithLetterhead() {
    const converter = new UltimateHTMLToPDFConverter();
    await converter.initialize();
    
    const htmlContent = `
        <html>
            <body>
                <h1>Professional Document</h1>
                <p>This document will have Trivanta Edge letterhead on all pages.</p>
            </body>
        </html>
    `;
    
    const result = await converter.convertHTMLToPDF(htmlContent, 'output.pdf', {
        format: 'A4',
        landscape: false,
        margin: { top: '12mm', right: '10mm', bottom: '14mm', left: '10mm' },
        scale: 1.0,
        letterhead: true  // Enable letterhead
    });
    
    console.log('PDF generated:', result.outputPath);
    console.log('File size:', result.fileSize, 'bytes');
    console.log('Pages:', result.pageCount);
    
    await converter.close();
}
```

## ⚙️ Configuration Options

### Page Formats
- `A4` (default) - 210 × 297 mm
- `A3` - 297 × 420 mm
- `Letter` - 8.5 × 11 inches
- `Legal` - 8.5 × 14 inches
- `Tabloid` - 11 × 17 inches

### Margins
- `small` - 10mm top/right, 12mm bottom/left
- `medium` (default) - 12mm top/right, 14mm bottom/left
- `large` - 20mm top/right, 20mm bottom/left

### Scale
- Range: 0.8 to 1.2
- Default: 1.0 (100%)

### Letterhead Features
When `letterhead: true` is enabled:
- **Company Logo** - Trivanta Edge logo (60x60px)
- **Company Name** - "Trivanta Edge" in professional typography
- **Tagline** - "From Land to Legacy — with Edge"
- **Contact Information** - Email addresses, phone, location
- **Professional Footer** - Copyright and website information
- **Consistent Branding** - Appears on every page with proper spacing

## 🧪 Testing

Run the comprehensive test suite:

```bash
npm test
```

Tests cover:
- Basic HTML conversion
- Complex CSS rendering (gradients, flexbox, grid)
- Table formatting
- Image handling
- Page breaks
- Custom fonts
- Background support
- Letterhead functionality
- Performance benchmarks
- Error handling

## 📁 Project Structure

```
Converter/
├── src/
│   ├── converter.js      # Core conversion engine
│   └── server.js         # Express API server
├── public/
│   └── index.html        # Web interface
├── test/
│   └── test-converter.js # Test suite
├── temp/                 # Temporary files
├── uploads/              # File uploads
├── outputs/              # Generated PDFs
├── cli.js               # Command line interface
├── sample.html          # Demo HTML document
├── trivanta.png         # Company logo for letterhead
├── package.json
└── README.md
```

## 🔧 Advanced Features

### Custom CSS Enhancements
The converter automatically injects print-optimized CSS:
- `print-color-adjust: exact` for perfect color reproduction
- `page-break-inside: avoid` for tables, images, and lists
- `page-break-after: avoid` for headings
- `orphans` and `widows` control for text flow

### Page Break Control
Use CSS classes for manual page break control:
```html
<div class="page-break">Force new page</div>
<div class="avoid-break">Keep content together</div>
```

### Letterhead Customization
The letterhead includes:
- Fixed positioning on all pages
- Professional typography (Times New Roman)
- Company branding colors (#2c5282, #1a365d)
- Responsive layout with proper spacing
- Print-optimized styling

## ⚡ Performance Optimization

### Browser Optimization
- Headless Chrome with optimized flags
- Memory-efficient rendering
- Advanced caching strategies
- Parallel processing support

### Memory Management
- Automatic cleanup of temporary files
- Efficient resource handling
- Graceful shutdown procedures

## 🛡️ Security Features

- File upload validation (HTML only)
- Size limits (50MB max)
- Path traversal protection
- CORS configuration
- Input sanitization
- Secure file handling

## 🏢 Why This Converter is Ultimate?

1. **Precision** - Pixel-perfect CSS rendering with no compromises
2. **Completeness** - Supports all modern web features and standards
3. **Reliability** - Robust error handling and edge case management
4. **Performance** - Optimized for speed and memory efficiency
5. **Professional** - Letterhead support for business documents
6. **User Experience** - Multiple interfaces (Web, CLI, API) for every use case

## 🤝 Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Add tests for new functionality
5. Submit a pull request

## 📄 License

MIT License - see LICENSE file for details

## 🆘 Support

For issues, questions, or feature requests:
- Check the test suite for examples
- Review the API documentation
- Open an issue on GitHub

---

**Built with ❤️ for perfect PDF generation**
